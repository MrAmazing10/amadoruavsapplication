import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
#import geopandas as gpd
from sklearn import metrics
from sklearn.cluster import DBSCAN

# initialize global empty list
points = []
#open file
def create_list(points):
    with open("no_outliers.txt","r") as file:

     for i, line in enumerate(file):
          #excludes line 1       
          if i == 0:
                continue
          
          values = line.strip()
          #split into lat + long then add to 2d list
          lat, long = values.split()
          points.append([float(lat), float(long)])

     return points
#runs function
points = create_list(points)

def cluster(points):
     #finds clusters with radius of .0001 around each point to find others, with minimum amt of samples in this process being 50(has to find 49 others total)
     db = DBSCAN(eps=.0001, min_samples=50).fit(points)
     labels = db.labels_
     print(labels)

     # Number of clusters in labels, ignoring noise if present.(exactly as from dbscan docs)
     n_clusters = len(set(labels)) - (1 if -1 in labels else 0)
     n_noise = list(labels).count(-1)
     print("Estimated number of clusters: %d" % n_clusters)
     print("Estimated number of noise points: %d" % n_noise)
     return n_clusters,n_noise,labels

cluster(points)
def plot(points):
    
    x = [i[0] for i in points] #sets x-values
    y = [j[1] for j in points] #sets y-values
    #creates plot
    df = plt.scatter(x, y)
    plt.savefig('scatter_plot.png') #saves as file for me to view
plot(points)

def centroids(points,labels):
     sortedclusterpts = [] #creating 5 different lists(values will also be lists) where the clusters' respective points will go
     centroids = [] #creating list for all centroids to go in
     for i in range(len(points)):
          label = labels[i]
          if 0 <= label < 5 and label.isinteger() == True:  #checks if labels are within range just in case it's not
              sortedclusterpts[label].append(points[i])
     for i in sortedclusterpts:
          centroids.append(str(np.average(sortedclusterpts[i][0])) + str(np.average(sortedclusterpts[i][0]))) # calculating avg of each for lat and long, and adding them to a list of centroids
     return centroids
